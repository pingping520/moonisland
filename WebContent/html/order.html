<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>填写订单页</title>
    <link rel="stylesheet" type="text/css" href="../css/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="../icon/iconfont.css">
    <link rel="stylesheet" type="text/css" href="../css/order.css" />
</head>
<body>
<div id="wrap">
    <!--头部开始-->
    <div id="header" class="navbar-fixed-top">
        <div class="row">
            <div class="col-xs-2 text-right"><i class="iconfont icon-toLeft-copy"></i></div>
            <div class="col-xs-2 col-xs-push-8"></div>
            <div class="col-xs-8 text-center col-xs-pull-2">填写订单</div>
        </div>
    </div>
    <!--end-->

    <!--买家地址部分-->
    <div class="address container-fluid" id="checkaddress">
    	<div class="row">
	        <div class="col-xs-1 text-center"><i class="iconfont icon-map"></i></div>
	        <div class="col-xs-10" id="fill-address"><span>请填写收货地址</span></div>
	        <div class="col-xs-1"><i class="iconfont icon-qianjin"></i></div>
        </div>
    </div>
    <!--end-->
    <!--商品区域-->
    <div id ="main" class="container-fluid">
        <div class="liner row"></div>
        <div class="bar"></div>
        <div class="row product">
            <div class="col-xs-4 image">
                <img src="../images/gls.png" class="img-responsive center-block" alt="帕森(PARZIN)">
            </div>
            <div class="col-xs-8 text-left">
                <p>帕森(PARZIN) 男士太阳镜铝镁偏光太...</p>
                <p><small class="text-muted">颜色:黑框黑灰片</small></p>
                <p id="money">￥<span style="font-size:14px;">139</span>.00&nbsp;<span style="color:#58585a;" class="iconfont icon-jinggao"></span></p>
            </div>
        </div>
        <div id="middle" class="container-fluid">
            <div class="row"></div>
        </div>
    </div>
    <!--end-->

    <!--底部-->
    <div id="footer" class="footer navbar-fixed-bottom">
        <div class="container-fluid money1">
            <div class="row">
                <div class="col-xs-6 text-left">
                    <p>商品金额</p>
                </div>
                <div class="col-xs-6 text-right">
                    <p class="money">￥139.00</p>
                </div>
            </div>
            <div class="row">
                <div class="col-xs-6 text-left">
                    <p>运费</p>
                </div>
                <div class="col-xs-6 text-right">
                    <p class="money">+ ￥0.00</p>
                </div>
            </div>
        </div>
        <div class="container-fluid money2">
            <div class="row">
                <div class="col-xs-7 text-right money"><div>实付款:￥139.<small>00</small></div></div>
                <div class="col-xs-5"><div class="sub"><a href="#">提交订单</a></div></div>
            </div>
        </div>
    </div>
    <!-- end-->
</div>

<!-- 选择地址  -->
<div class="" id="selectAddress" style="display:none;">
	<div id="header" class="navbar-fixed-top">
        <div class="row">
            <div class="col-xs-2 text-right"><i class="iconfont icon-toLeft-copy rutn"></i></div>
            <div class="col-xs-2 col-xs-push-8"></div>
            <div class="col-xs-8 text-center col-xs-pull-2">选择地址</div>
        </div>
    </div>
    
    <div style="height:62px;"></div>
    
    <!-- 选择地址内容 -->
    <div id="addressContent"></div>
    
    <!-- <div id="" style="padding:8px 0px;border-bottom:1px solid #ccc;">
    	<div class="container-fluid">
			<div class="row">
				<div class="col-xs-7" style="font-size:14px;" id="receiver">收货人：<span>二狗子二</span></div>
				<div class="col-xs-1"></div>
				<div class="col-xs-4" style="font-size:14px;" id="telephone">18332368683</div>
			</div>
			<div class="row">
				<div class="col-xs-12"><div style="font-size:14px;" id="deliveryAddress">收货地址：<span>河北省石家庄市裕华区  建设南大街河北师大西门，科技楼b座5楼博看文思</span></div></div>
			</div>
		</div>
    </div> -->
	
	
	<div style="height:50px;"></div>
	
	<div id="footer2" class="footer navbar-fixed-bottom">
        <div class="container-fluid money2">
            <div class="row">
                <div class="col-xs-12" style="padding:0px;"><div id="addAddress" class="sub" style="color:white;text-align:center;">新增收货地址</div></div>
            </div>
        </div>
    </div>
</div>

<!-- 新增地址 -->
<div class="" id="area" style="display:none;">
	<div id="header" class="navbar-fixed-top">
        <div class="row">
            <div class="col-xs-2 text-right"><i class="iconfont icon-toLeft-copy rutn"></i></div>
            <div class="col-xs-2 col-xs-push-8"></div>
            <div class="col-xs-8 text-center col-xs-pull-2">填写地址</div>
        </div>
    </div>
    <div style="height:62px;"></div>
		<div class="container-fluid">
			<div id="pcd" class="col-xs-12">
				<ul class="province" style="list-style: none; padding-left: 0;"></ul>
			</div>
			<div id="detailed-info" style="display:none;">
				<div id="pcd-address" class="col-xs-12" style="padding-top:10px;"></div>
				<div id="detailed-address" class="col-xs-12" style="padding-bottom:20px;">
					<input id="detailed-address-input" type="text" class="form-control" placeholder="请输入详细地址">
				</div>
				<div id="name-address" class="col-xs-12" style="padding-bottom:20px;">
					<input id="name-address-input" type="text" class="form-control" placeholder="请输入收货人姓名">
				</div>
				<div id="tell-address" class="col-xs-12" style="padding-bottom:20px;">
					<input id="tell-address-input" type="text" class="form-control" placeholder="请输入收货人电话">
				</div>
				<div id="zip-code" class="col-xs-12" style="padding-bottom:20px;">
					<input id="zip-code-input" type="text" class="form-control" placeholder="请输入邮政编码">
				</div>	
			</div>
		</div>
	<div style="height:50px;"></div>
	<div id="footer2" class="footer navbar-fixed-bottom">
        <div class="container-fluid money2">
            <div class="row">
                <div class="col-xs-12" style="padding:0px;"><div id="addbtn" class="sub" style="color:white;text-align:center;">确定</div></div>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript" src="../js/jquery-1.11.0.min.js"></script>
<script type="text/javascript" src="../js/bootstrap.min.js"></script>
<script type="text/javascript">

function fun01(){
	$.get("../area/findall/0",function(data){
		var ls = "";
		for(var i=0;i<data.length;i++){
			var title = data[i].title;
			var areaId = data[i].areaId;
			ls += "<li value="+areaId+" onclick='province(this)' style='padding:5px 0;'>"+title+"</li>";
		}
		$('.province').find("li").remove();
		$('.province').append(ls);
	})
}
	
	function province(obj){
		var province = $(obj).text();
		var id = $(obj).val();
		var ctid = $('#ct').val();
		if(id!=ctid){
			$.get("../area/findall/"+id,function(data){
				var ls = "";
				ls += "<li id='pro' value="+id+" onclick='fun01()' style='background:#ccc;padding:5px 0;'>"+province+"</li>";
				for(var i=0;i<data.length;i++){
					var title = data[i].title;
					var areaId = data[i].areaId;
					ls += "<li value="+areaId+" onclick='city(this)' style='padding:5px 0;'>"+title+"</li>";
				}
			
				$('.province').find("li").remove();
				$('.province').append(ls);
			})
		}else{
			var pro2id = $('#pro2').val();
			var pro2 = $('#pro2').text();
			$.get("../area/findall/"+pro2id,function(data){
				var ls = "";
				ls += "<li id='pro' value="+pro2id+" onclick='fun01()' style='background:#ccc;padding:5px 0;'>"+pro2+"</li>";
				for(var i=0;i<data.length;i++){
					var title = data[i].title;
					var areaId = data[i].areaId;
					ls += "<li value="+areaId+" onclick='city(this)' style='padding:5px 0;'>"+title+"</li>";
				}
			
				$('.province').find("li").remove();
				$('.province').append(ls);
			})
		}
		
	}
	function city(obj){
		var pro = $('#pro').text();
		var proid = $('#pro').val();
		var city = $(obj).text();
		var cityid = $(obj).val();
		var id = $(obj).val(); 
		$.get("../area/findall/"+cityid,function(data){
			var ls = "";
			ls += "<li id='pro2' value="+proid+" onclick='fun01()' style='background:#ccc;padding:5px 0;'>"+pro+"</li>";
			ls += "<li id='ct' value="+cityid+" onclick='province(this)' style='background:#ddd;padding:5px 0;'>"+city+"</li>";
			for(var i=0;i<data.length;i++){
				var title = data[i].title;
				var areaId = data[i].areaId;
				ls += "<li value="+areaId+" onclick='address(this)' style='padding:5px 0;'>"+title+"</li>";
			}
			$('.province').find("li").remove();
			$('.province').append(ls);
		})
	}
	
	function address(obj){
		var p = $('#pro2').text();
		var c = $('#ct').text();
		var d = $(obj).text();
		var pcd = "<p><span class='p'>"+p+" </span><span class='c'>"+c+" </span><span class='d'>"+d+"</p>";
		$('#pcd').css('display','none');
		$('#pcd-address').find("p").remove();
		$('#pcd-address').append(pcd);
		$('#detailed-info').css('display','block');
	}
	
	$('#checkaddress').click(function(){
		$('#wrap').css('display','none');
		$('#selectAddress').css('display','block');
		$('#pcd').css('display','block');
		$('#detailed-info').css('display','none');
	});
	$('.rutn').click(function(){
		$('#selectAddress').css('display','none');
		$('#area').css('display','none');
		$('#wrap').css('display','block');
	})
	$('#pcd-address').click(function(){
		$('#area').css('display','block');
		$('#pcd').css('display','block');
		$('#detailed-info').css('display','none');
	})
	
	/*点击添加地址*/
	$('#addbtn').click(function(){
		/*获取用户添加的地址信息*/
		var p = $('.p').text();
		var c = $('.c').text();
		var d = $('.d').text();
		var detailed = $('#detailed-address-input').val();
		var name = $('#name-address-input').val();
		var tell = $('#tell-address-input').val();
		var zip = $('#zip-code-input').val();
		
		/*用户ID需要从session中取出*/
		var a = {'province':p,'city':c,'district':d,'address':detailed,'zipcode':zip,'phone':tell,'user.userId':75,'receiverName':name};
		$.post("../address/add",a,function(data){
			var ls = "";
			ls += '<div style="padding:8px 0px;border-bottom:1px solid #ccc;" onclick="useAddress(this)"><div class="container-fluid"><div class="row">';
			ls += '<div class="col-xs-7" style="font-size:14px;">收货人：<span class="receiver">'+name+'</span></div>';
			ls += '<div class="col-xs-1"></div><div class="col-xs-4" style="font-size:14px;"><span class="telephone">'+tell+'</span></div></div>';
			ls += '<div class="row"><div class="col-xs-12"><div style="font-size:14px;">收货地址：<span class="deliveryAddress">'+p+c+d+" "+detailed+'</span></div></div></div></div></div>';
			$('#addressContent').append(ls);
			$('#area').css('display','none');
			$('#wrap').css('display','none');
			$('#selectAddress').css('display','block');
		})
	})
	
	/*显示用户可用地址*/
	$.get("../address/findAll/"+75,function(data){
		var ls = "";
		for(var i=0;i<data.length;i++){
			var addr = data[i];
			ls += '<div style="padding:8px 0px;border-bottom:1px solid #ccc;" onclick="useAddress(this)"><div class="container-fluid"><div class="row">';
			ls += '<div class="col-xs-7" style="font-size:14px;">收货人：<span class="receiver">'+addr.receiverName+'</span></div>';
			ls += '<div class="col-xs-1"></div><div class="col-xs-4" style="font-size:14px;"><span class="telephone">'+addr.phone+'</span></div></div>';
			ls += '<div class="row"><div class="col-xs-12"><div style="font-size:14px;">收货地址：<span class="deliveryAddress">'+addr.province+addr.city+addr.district+" "+addr.address+'</span></div></div></div></div></div>';
		}
	    $('#addressContent').append(ls);
	})
	
	/*点击使用地址*/
	function useAddress(obj){
		$(obj).css('background','#ddd');
		$(obj).siblings('div').css('background','#fff');
		var receiver = $(obj).find('.receiver').text();
		var telephone = $(obj).find('.telephone').text();
		var deliveryAddress = $(obj).find('.deliveryAddress').text();
		var rtd = "<span>收货人："+receiver+"  电话："+telephone+"  收货地址："+deliveryAddress+"</span>";
		$('#fill-address').find("span").remove();
		$('#fill-address').append(rtd);
		$('#selectAddress').css('display','none');
		$('#wrap').css('display','block');
	}
	
	/*新增地址*/
	$('#addAddress').click(function(){
		fun01();
		$('#area').css('display','block');
		$('#selectAddress').css('display','none');
	})
</script>
</body>
</html>